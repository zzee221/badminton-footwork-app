# 羽毛球步伐训练应用

一个基于Web的羽毛球步伐训练系统，帮助用户学习和练习羽毛球步伐技巧。

## 🏸 项目简介

本应用提供交互式的羽毛球步伐训练，用户可以通过点击羽毛球场地图上的点位来查看不同步伐组合的视频演示。系统支持两种主要的启动方式：平行启动和前后启动，并为不同用户级别提供相应的访问权限。

## ✨ 主要功能

### 🎯 交互式学习
- 点击场地点位选择起点和终点
- 实时显示对应的步伐视频演示
- 支持多种步伐模式切换
- 详细的步伐说明和技术要点

### 👥 用户系统
- **免费用户**：可访问8个基础步伐视频
- **会员用户**：解锁所有18个点位组合和30个视频
- 简化的注册/登录流程
- 个人中心和学习记录

### 📱 响应式设计
- 适配桌面和移动设备
- 直观的用户界面
- 流畅的动画效果

## 🏗️ 技术架构

### 前端技术栈
- **HTML5** + **CSS3** + **JavaScript**
- **Tailwind CSS** - 现代化的UI框架
- **Supabase** - 后端服务和数据库
- **响应式设计** - 支持多种设备

### 数据库设计
- **用户管理** (profiles)
- **订阅系统** (subscriptions)
- **激活码系统** (activation_codes)
- **激活历史** (activation_history)

### 步伐配置系统
- 配置化的步伐管理
- 灵活的权限控制
- 自动化视频关联
- 动态列表生成

## 🔄 开发状态和待解决问题

### 当前版本：V2.3.0 (2025-08-08)

### ✅ 已完成功能
- [x] 完整的用户认证系统
- [x] 会员订阅和激活码功能
- [x] 步伐配置管理系统
- [x] 响应式UI设计
- [x] 数据库架构设计
- [x] 行级安全策略
- [x] 视频播放控制
- [x] 步伐列表动态生成
- [x] 用户状态显示修复
- [x] 步伐类型筛选功能

### 🔧 当前待解决问题
1. **激活历史记录问题**
   - 问题：激活码使用后，`activation_history` 表没有自动记录
   - 状态：已创建修复方案 (`database-schema-fixed.sql`)
   - 待办：在Supabase控制台执行修复脚本

2. **激活码失效问题**
   - 问题：部分激活码在首次使用后失效
   - 可能原因：触发器权限或RLS策略问题
   - 解决方案：放宽RLS策略，简化触发器逻辑

### 🚨 最近修复的问题
- **用户状态显示**：修复了会员类型映射问题（"30天会员"、"永久会员"）
- **步伐列表混乱**：修复了列表筛选逻辑，只显示当前选择的步伐类型
- **标题显示**：将"点位组合列表"改为"步伐列表"

### 📋 下一步开发计划
1. **数据库触发器修复**
   - [ ] 执行 `database-schema-fixed.sql` 脚本
   - [ ] 测试激活历史记录功能
   - [ ] 验证所有激活码正常工作

2. **功能优化**
   - [ ] 添加激活码批量管理功能
   - [ ] 优化视频加载性能
   - [ ] 添加用户操作日志

3. **内容扩展**
   - [ ] 增加更多步伐变体
   - [ ] 添加步伐训练计划
   - [ ] 引入学习进度跟踪

### 🔍 开发注意事项
- **数据库版本**：使用 `database-schema-fixed.sql` 作为最新版本
- **激活码测试**：使用 `NEWDEMO` 和 `LIFETIME2025` 等新激活码
- **触发器调试**：检查Supabase日志中的触发器执行情况
- **RLS策略**：确保 `activation_history` 表的插入权限正确配置

### 📊 当前内容统计
- **点位组合**：18个
- **视频总数**：30个
- **步伐类型**：2种（平行启动、前后启动）
- **免费内容**：8个点位组合，8个视频
- **会员内容**：18个点位组合，30个视频

---

## 🎮 步伐系统详解

### 场地点位布局
```
   中场(1)
    /    \
反手网前(2)  正手网前(3)
    |      |
反手中场(6)  正手中场(7)
    |      |
头顶后场(4)  正手后场(5)
```

### 启动方式

#### 1. 平行启动（防守站位）
- **适用场景**：起高球、防守状态
- **特点**：双脚平行站立，向各个方向移动灵活
- **点位组合**：1-2, 1-3, 1-4, 1-5, 1-6, 1-7

#### 2. 前后启动（进攻站位）
- **适用场景**：下压球、进攻状态
- **特点**：前后脚站立，启动速度快，爆发力强
- **点位组合**：完整的12个点位组合

### 步伐模式
每个点位组合可能包含多种步伐模式：
- **基础步伐**：标准步伐动作
- **进阶步伐**：高级技巧和变化
- **特殊步伐**：特定场景下的步伐变体

## 🔐 用户权限系统

### 免费用户权限
**可访问的步伐组合：**
- 平行启动：1-2, 1-3, 1-4, 1-5（基础步伐）
- 前后启动：1-2, 1-3, 1-4, 1-5（基础步伐）
- 总计：8个点位组合，8个基础视频

### 会员用户权限
**解锁所有内容：**
- 平行启动：全部6个点位组合，包含进阶模式
- 前后启动：全部12个点位组合，包含高级模式
- 总计：18个点位组合，30个视频演示

## 📁 项目结构

```
羽毛球步伐（surface）/
├── index.html                    # 主页面
├── script.js                    # 主要业务逻辑
├── step-config.js               # 步伐配置管理
├── auth.js                     # 用户认证系统
├── supabase-config.js          # 数据库配置
├── styles.css                  # 样式文件
├── database-schema-new.sql     # 原始数据库架构
├── database-schema-fixed.sql  # 修复后的数据库架构（最新版本）
├── 步伐MP4图/                  # 视频文件目录
│   ├── 平行启动*.mp4
│   └── 前后启动*.mp4
├── 羽毛球场地半场示意图.jpg
├── CLAUDE.md                   # Claude开发指令
└── README.md                   # 项目说明文档
```

## 🚀 快速开始

### 环境要求
- 现代浏览器（支持HTML5、CSS3、ES6）
- 网络连接（用于用户认证和数据同步）

### 本地运行
1. 克隆或下载项目文件
2. 确保Supabase配置正确
3. 用浏览器打开 `index.html`

### 部署到服务器
1. 上传所有文件到Web服务器
2. 配置Supabase项目
3. 确保CORS设置正确

## 🔧 配置说明

### Supabase配置
在 `supabase-config.js` 中配置数据库连接：
```javascript
const SUPABASE_URL = 'your-supabase-url';
const SUPABASE_ANON_KEY = 'your-anon-key';
```

### 数据库初始化
1. **首次部署**：执行 `database-schema-new.sql`
2. **修复问题**：执行 `database-schema-fixed.sql`（推荐使用此版本）
3. **验证安装**：检查所有表是否正确创建

### 步伐配置
在 `step-config.js` 中管理所有步伐数据：
- 添加新的步伐类型
- 配置视频文件路径
- 设置访问权限
- 管理步伐模式

### 激活码管理
系统预置了以下测试激活码：
- `NEWDEMO` - 30天会员
- `LIFETIME2025` - 永久会员
- `DEMO30` - 30天会员
- `DEMOLIFETIME` - 永久会员

## 📊 数据统计

### 内容规模
- **点位组合**：18个
- **视频总数**：30个
- **步伐类型**：2种
- **用户级别**：2级

### 免费内容
- **点位组合**：8个
- **视频数量**：8个
- **覆盖率**：44%

### 会员内容
- **点位组合**：18个
- **视频数量**：30个
- **覆盖率**：100%

## 💡 使用指南

### 基本操作
1. **选择启动方式**：点击顶部的平行启动/前后启动切换
2. **选择点位**：点击场地上的红色点位
3. **观看视频**：系统自动播放对应步伐视频
4. **切换模式**：使用左右箭头切换不同步伐模式

### 高级功能
- **个人中心**：查看学习进度和会员状态
- **会员升级**：使用激活码解锁全部内容
- **步伐列表**：快速访问所有可用步伐

## 🎯 学习建议

### 初学者
1. 从基础步伐开始练习
2. 重点关注平行启动的1-2、1-3、1-4、1-5
3. 每个步伐重复观看多次
4. 模仿视频中的动作要领

### 进阶用户
1. 学习前后启动的不同组合
2. 掌握各种步伐模式的变化
3. 理解不同场景下的步伐选择
4. 结合实际打球练习

## 🔮 未来规划

### 紧急修复任务
- [ ] 修复激活历史记录触发器问题
- [ ] 解决激活码失效问题
- [ ] 验证数据库RLS策略配置
- [ ] 测试所有用户流程

### 功能扩展
- [ ] 添加步伐训练计划
- [ ] 引入学习进度跟踪
- [ ] 增加步伐评估系统
- [ ] 支持自定义训练组合
- [ ] 激活码批量管理功能
- [ ] 用户操作日志记录

### 内容扩展
- [ ] 增加反手步伐专项
- [ ] 添加被动步伐训练
- [ ] 引入比赛场景模拟
- [ ] 支持多角度视频展示
- [ ] 步伐难度分级系统

### 技术优化
- [ ] 离线模式支持
- [ ] 视频预加载优化
- [ ] 移动端性能优化
- [ ] 国际化多语言支持
- [ ] 数据库性能优化
- [ ] 错误处理机制完善

## 🛡️ 安全考虑

### 数据安全
- 使用Supabase Row Level Security
- JWT token身份验证
- 安全的密码存储
- 防SQL注入防护

### 内容保护
- 会员内容权限控制
- 激活码使用限制
- 防盗链措施
- 访问日志记录

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进项目。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- GitHub Issues
- 邮件：[your-email@example.com]

---

**羽毛球步伐训练应用** - 让步伐训练更简单、更高效！ 🏸✨